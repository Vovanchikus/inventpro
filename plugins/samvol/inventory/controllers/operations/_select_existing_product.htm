<div class="modal-body">
    <form data-request="onSelectExistingProduct">
        <input
            type="hidden"
            name="_operation_id"
            value="<?= $operation->id ?>"
        />

        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th style="width: 40px">#</th>
                    <th>Название</th>
                    <th>Ед. изм.</th>
                    <th style="width: 120px">На складе</th>
                    <th style="width: 100px">Количество</th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($products as $product): ?>
                <tr>
                    <td>
                        <input
                            type="checkbox"
                            name="products[<?= $product->id ?>][id]"
                            value="<?= $product->id ?>"
                        />
                    </td>
                    <td><?= e($product->name) ?></td>
                    <td><?= e($product->unit) ?></td>
                    <td><?= e($product->quantity) ?></td>
                    <!-- используем getQuantityAttribute() -->
                    <td>
                        <input
                            type="number"
                            name="products[<?= $product->id ?>][quantity]"
                            value="1"
                            min="1"
                            class="form-control input-sm"
                        />
                    </td>
                </tr>
                <?php endforeach ?>
            </tbody>
        </table>

        <div class="modal-footer">
            <button type="submit" class="btn btn-primary">
                <i class="icon-plus"></i> Добавить выбранные
            </button>
            <button type="button" class="btn btn-default" data-dismiss="popup">
                Отмена
            </button>
        </div>
    </form>
</div>
